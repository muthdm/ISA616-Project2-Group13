---
title: "Student Success Dashboard"
output: 
  flexdashboard::flex_dashboard:
    orientation: rows
#runtime: shiny
---

```{r setup, include=FALSE,echo=FALSE}
knitr::opts_chunk$set(echo = TRUE,message=FALSE,warning=FALSE)

#package intialization
if(require(pacman)==FALSE) install.packages("pacman")
pacman::p_load(tidyverse, #for data manipulation
               plotly, #for interactive plots
               flexdashboard, #to make a dashboard
               fontawesome, #for icons
               DT, #for better tables
               ggplot
               )

df = read_csv("clean_data.csv")
companies = read_csv("top_companies.csv")
```

# Overview and Insights {data-orientation=columns}

## Column {data-width=500}

### Project/Problem Overview

Show salaries of Farmer students. 

### Our Solution

We will create histograms.

## Column {data-width=500}

### Insights and Conclusions

### Links

Indiana University Salaries: https://kelley.iu.edu/recruiters-companies/undergrad/statistics/salary-statistics/index.html

Ohio State Salaries: https://fisher.osu.edu/careers-recruiting/salary-outcome-data

# Major Salaries by Year {data-orientation=columns}

## Column {data-width=333}

```{r, fig.width = 4, fig.height=2.5, echo=FALSE}
finance_data <- df[df$major1 == "Finance", ]

# Create a separate histogram for each year
ggplot(finance_data, aes(x = survey_salary)) +
  geom_histogram(binwidth = 1000, fill = "blue", color = "black") +
  facet_wrap(~year.x, scales = "free_x") +
  labs(
    title = "Histogram of Finance Major Salaries",
    x = "Salary",
    y = "Frequency"
  ) +
  theme_minimal()+
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5))
```

```{r, fig.width = 4, fig.height=2.5, echo=FALSE}
analytics_data <- df[df$major1 == "Business Analytics", ]

# Create a separate histogram for each year
ggplot(analytics_data, aes(x = survey_salary)) +
  geom_histogram(binwidth = 1000, fill = "blue", color = "black") +
  facet_wrap(~year.x, scales = "free_x") +
  labs(
    title = "Histogram of Business Analytics Major Salaries",
    x = "Salary",
    y = "Frequency"
  ) +
  theme_minimal()+
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5))
```

```{r, fig.width = 4, fig.height=2.5, echo=FALSE}
economics_data <- df[df$major1 == "Business Economics", ]

# Create a separate histogram for each year
ggplot(economics_data, aes(x = survey_salary)) +
  geom_histogram(binwidth = 1000, fill = "blue", color = "black") +
  facet_wrap(~year.x, scales = "free_x") +
  labs(
    title = "Histogram of Economics Major Salaries",
    x = "Salary",
    y = "Frequency"
  ) +
  theme_minimal()+
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5))
```

## Column {data-width=333}

```{r, fig.width = 4, fig.height=2.5, echo=FALSE}
marketing_data <- df[df$major1 == "Marketing", ]

# Create a separate histogram for each year
ggplot(marketing_data, aes(x = survey_salary)) +
  geom_histogram(binwidth = 1000, fill = "blue", color = "black") +
  facet_wrap(~year.x, scales = "free_x") +
  labs(
    title = "Histogram of Marketing Major Salaries",
    x = "Salary",
    y = "Frequency"
  ) +
  theme_minimal()+
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5))
```

```{r, fig.width = 4, fig.height=2.5, echo=FALSE}
entre_data <- df[df$major1 == "Entrepreneurship", ]

# Create a separate histogram for each year
ggplot(entre_data, aes(x = survey_salary)) +
  geom_histogram(binwidth = 1000, fill = "blue", color = "black") +
  facet_wrap(~year.x, scales = "free_x") +
  labs(
    title = "Histogram of Entrepreneurship Major Salaries",
    x = "Salary",
    y = "Frequency"
  ) +
  theme_minimal()+
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5))
```

```{r, fig.width = 4, fig.height=2.5, echo=FALSE}
supply_data <- df[df$major1 == "Supply Chain & Operations Mgmt", ]

# Create a separate histogram for each year
ggplot(supply_data, aes(x = survey_salary)) +
  geom_histogram(binwidth = 1000, fill = "blue", color = "black") +
  facet_wrap(~year.x, scales = "free_x") +
  labs(
    title = "Histogram of Supply Chain Major Salaries",
    x = "Salary",
    y = "Frequency"
  ) +
  theme_minimal()+
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5))
```

## Column {data-width=333}

```{r, fig.width = 4, fig.height=2.5, echo=FALSE}
accountancy_data <- df[df$major1 == "Accountancy", ]

# Create a separate histogram for each year
ggplot(accountancy_data, aes(x = survey_salary)) +
  geom_histogram(binwidth = 1000, fill = "blue", color = "black") +
  facet_wrap(~year.x, scales = "free_x") +
  labs(
    title = "Histogram of Marketing Major Salaries",
    x = "Salary",
    y = "Frequency"
  ) +
  theme_minimal()+
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5))
```

```{r, fig.width = 4, fig.height=2.5, echo=FALSE}
mgmt_data <- df[df$major1 == "Management and Leadership", ]

# Create a separate histogram for each year
ggplot(mgmt_data, aes(x = survey_salary)) +
  geom_histogram(binwidth = 1000, fill = "blue", color = "black") +
  facet_wrap(~year.x, scales = "free_x") +
  labs(
    title = "Histogram of Management and Leadership Major Salaries",
    x = "Salary",
    y = "Frequency"
  ) +
  theme_minimal()+
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5))
```

```{r, fig.width = 4, fig.height=2.5, echo=FALSE}
information_data <- df[df$major1 == "Information Systems", ]

# Create a separate histogram for each year
ggplot(information_data, aes(x = survey_salary)) +
  geom_histogram(binwidth = 1000, fill = "blue", color = "black") +
  facet_wrap(~year.x, scales = "free_x") +
  labs(
    title = "Histogram of Information Systems Salaries",
    x = "Salary",
    y = "Frequency"
  ) +
  theme_minimal()+
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5))
```

# FSB {data-orientation=columns}

## Column {data-width=400}

### Farmer's Average Salries by Major by Year

```{r,echo=FALSE}
result <- df %>%
  group_by(major1, year.x) %>%
  summarise(average_salary = mean(survey_salary, na.rm = TRUE)) %>%
  ungroup()

plotly_chart <- result %>%
  plot_ly(x = ~factor(year.x), y = ~average_salary, color = ~major1, type = "scatter", mode = "lines") %>%
  layout(
    xaxis = list(title = "Year"),
    yaxis = list(title = "Average Salary"),
    showlegend = TRUE
  )

plotly_chart
```

### FSB's Salries as a Whole by Year

```{r,echo=FALSE}
x_axis_range <- c(0, 100000)  # Used 100,000 to get a more accurate look of the shape of the histogram

# Create a separate histogram for each year
ggplot(df, aes(x = survey_salary)) +
  geom_histogram(binwidth = 5000, fill = "blue", color = "black") +
  facet_wrap(~year.x) +
  labs(
    title = "Histogram of FSB Salaries by Year",
    x = "Salary",
    y = "Frequency"
  ) +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5)) +
  coord_cartesian(xlim = x_axis_range)
```


## Column {data-width=600}

### Comparable School's Average Salaries

```{r,echo=FALSE}

```


# Salaries by Top Companies {data-orientation=columns}

## Column {data-width=500}

### Top 10 Companies
```{r,echo=FALSE}
data = companies %>%
  #filter(intern_status == "Yes") %>%
  #filter(pay_status == "Yes") %>%
  group_by(survey_company, year.x, major1, survey_salary) %>%
  summarize(count=n()) %>%
  arrange(survey_company, year.x, major1, survey_salary, -count)

#data$employer = fct_explicit_na(data$employer, "unkown")
#finding all NAs and putting it into "unknown" category


datatable(data, rownames=F, extensions = "Buttons", 
          options =list(dom = "Bfrtip",
                        buttons=c("copy", "csv", "excel")
                        ),
          filter = list(position = "bottom",
                        clear=F,plain= T
                        )
          )
```

### Deloitte Average Salaries

```{r, echo =FALSE, fig.width = 8, fig.height=6}
#Deloitte Bar Chart

filtered_data <- companies %>%
  filter(survey_company == "DELOITTE") %>%
  group_by(major1, survey_company) %>%
  summarise(average_salary = mean(survey_salary))

# Create a responsive plotly bar chart for "DELOITTE"
plot_ly(filtered_data, x = ~major1, y = ~average_salary, type = "bar", marker = list(color = "blue")) %>%
  layout(xaxis = list(title = "Major"),
         yaxis = list(title = "Average Salary"),
         barmode = "group")

```

## Column {data-width=500}

### EY Average Salaries

```{r, echo = FALSE, fig.width = 4, fig.height=2.5}
#EY

filtered_data <- companies %>%
  filter(survey_company == "EY") %>%
  group_by(major1, survey_company) %>%
  summarise(average_salary = mean(survey_salary))

# Create a responsive plotly bar chart for "EY"
plot_ly(filtered_data, x = ~major1, y = ~average_salary, type = "bar", marker = list(color = "blue")) %>%
  layout(xaxis = list(title = "Major"),
         yaxis = list(title = "Average Salary"),
         barmode = "group")
```

### Textron Average Salries

```{r, echo = FALSE, fig.width = 4, fig.height=2.5}
#Textron Bar Chart

filtered_data <- companies %>%
  filter(survey_company == "TEXTRON") %>%
  group_by(major1, survey_company) %>%
  summarise(average_salary = mean(survey_salary))

# Create a responsive plotly bar chart for "TEXTRON"
plot_ly(filtered_data, x = ~major1, y = ~average_salary, type = "bar", marker = list(color = "blue")) %>%
  layout(xaxis = list(title = "Major"),
         yaxis = list(title = "Average Salary"),
         barmode = "group")

```


