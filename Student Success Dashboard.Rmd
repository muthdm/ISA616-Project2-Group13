---
title: "Student Success Dashboard"
output: 
  flexdashboard::flex_dashboard:
    orientation: rows
#runtime: shiny
---

```{r setup, include=FALSE,echo=FALSE}
knitr::opts_chunk$set(echo = TRUE,message=FALSE,warning=FALSE)

#package intialization
if(require(pacman)==FALSE) install.packages("pacman")
pacman::p_load(tidyverse, #for data manipulation
               plotly, #for interactive plots
               flexdashboard, #to make a dashboard
               fontawesome, #for icons
               DT, #for better tables
               ggplot
               )

df = read_csv("clean_data.csv")
companies = read_csv("top_companies.csv")
```

# Overview and Insights {data-orientation=columns}

## Column {data-width=500}

### Project/Problem Overview

Show salaries of Farmer students. 

### Our Solution

We will create histograms.

## Column {data-width=500}

### Insights and Conclusions

1. Information Systems and Business Analytics majors tend to make the highest salaries, with Finance and Economics trailing slightly behind. Marketing to a big dip in 2021 to be the lowest payng major. 

2. When comparing Farmer with Kelley School of Business and Fisher School of Business, we see that Kelley outperforms the other schools for all majors. Farmer and Fisher go back and forth for majors but are roughly the same.

3. For top companies, Information Systems tend to make the highest average salaries. 

### Links

Indiana University Salaries: https://kelley.iu.edu/recruiters-companies/undergrad/statistics/salary-statistics/index.html

Ohio State Salaries: https://files.fisher.osu.edu/careers-recruiting/public/2021-10/AnnualReport2021.pdf?VersionId=UnbXIIgZenGaz8EVfozFCS1lJrl9bf5A

CPI Inflation Calculator: 
https://www.officialdata.org/us/inflation/2022?endYear=2021&amount=60000

# Major Salaries by Year {data-orientation=columns}

## Column {data-width=333}

###

```{r, fig.width = 4, fig.height=2.5, echo=FALSE}
finance_data <- df[df$major1 == "Finance", ]

# Create a separate histogram for each year
plot <- ggplot(finance_data, aes(x = survey_salary)) +
  geom_histogram(binwidth = 1000, fill = "blue", color = "black") +
  facet_wrap(~year.x, scales = "free_x") +
  labs(
    title = "Histogram of Finance Major Salaries",
    x = "Salary",
    y = "Frequency"
  ) +
  scale_x_continuous(labels = scales::number_format(scale = 1)) + 
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5))

interactive_plot <- ggplotly(plot)

interactive_plot
```

###

```{r, fig.width = 4, fig.height=2.5, echo=FALSE}
analytics_data <- df[df$major1 == "Business Analytics", ]

# Create a separate histogram for each year
plot <- ggplot(analytics_data, aes(x = survey_salary)) +
  geom_histogram(binwidth = 1000, fill = "blue", color = "black") +
  facet_wrap(~year.x, scales = "free_x") +
  labs(
    title = "Histogram of Business Analytics Major Salaries",
    x = "Salary",
    y = "Frequency"
  ) +
  scale_x_continuous(labels = scales::number_format(scale = 1)) + 
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5))

interactive_plot <- ggplotly(plot)

interactive_plot
```

###

```{r, fig.width = 4, fig.height=2.5, echo=FALSE}
economics_data <- df[df$major1 == "Business Economics", ]

# Create a separate histogram for each year
plot <- ggplot(economics_data, aes(x = survey_salary)) +
  geom_histogram(binwidth = 1000, fill = "blue", color = "black") +
  facet_wrap(~year.x, scales = "free_x") +
  labs(
    title = "Histogram of Economics Major Salaries",
    x = "Salary",
    y = "Frequency"
  ) +
  scale_x_continuous(labels = scales::number_format(scale = 1)) + 
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5))

interactive_plot <- ggplotly(plot)

interactive_plot
```

## Column {data-width=333}

###

```{r, fig.width = 4, fig.height=2.5, echo=FALSE}
marketing_data <- df[df$major1 == "Marketing", ]

# Create a separate histogram for each year
plot <- ggplot(marketing_data, aes(x = survey_salary)) +
  geom_histogram(binwidth = 1000, fill = "blue", color = "black") +
  facet_wrap(~year.x, scales = "free_x") +
  labs(
    title = "Histogram of Marketing Major Salaries",
    x = "Salary",
    y = "Frequency"
  ) +
  scale_x_continuous(labels = scales::number_format(scale = 1)) + 
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5))

interactive_plot <- ggplotly(plot)

interactive_plot
```

###

```{r, fig.width = 4, fig.height=2.5, echo=FALSE}
entre_data <- df[df$major1 == "Entrepreneurship", ]

# Create a separate histogram for each year
plot <- ggplot(entre_data, aes(x = survey_salary)) +
  geom_histogram(binwidth = 1000, fill = "blue", color = "black") +
  facet_wrap(~year.x, scales = "free_x") +
  labs(
    title = "Histogram of Entreprenuership Major Salaries",
    x = "Salary",
    y = "Frequency"
  ) +
  scale_x_continuous(labels = scales::number_format(scale = 1)) + 
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5))

interactive_plot <- ggplotly(plot)

interactive_plot
```

### 

```{r, fig.width = 4, fig.height=2.5, echo=FALSE}
supply_data <- df[df$major1 == "Supply Chain & Operations Mgmt", ]

# Create a separate histogram for each year
plot <- ggplot(supply_data, aes(x = survey_salary)) +
  geom_histogram(binwidth = 1000, fill = "blue", color = "black") +
  facet_wrap(~year.x, scales = "free_x") +
  labs(
    title = "Histogram of Supply Chain Major Salaries",
    x = "Salary",
    y = "Frequency"
  ) +
  scale_x_continuous(labels = scales::number_format(scale = 1)) + 
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5))

interactive_plot <- ggplotly(plot)

interactive_plot
```

## Column {data-width=333}

###

```{r, fig.width = 4, fig.height=2.5, echo=FALSE}
accountancy_data <- df[df$major1 == "Accountancy", ]

# Create a separate histogram for each year
plot <- ggplot(accountancy_data, aes(x = survey_salary)) +
  geom_histogram(binwidth = 1000, fill = "blue", color = "black") +
  facet_wrap(~year.x, scales = "free_x") +
  labs(
    title = "Histogram of Accountancy Major Salaries",
    x = "Salary",
    y = "Frequency"
  ) +
  scale_x_continuous(labels = scales::number_format(scale = 1)) + 
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5))

interactive_plot <- ggplotly(plot)

interactive_plot
```

###

```{r, fig.width = 4, fig.height=2.5, echo=FALSE}
mgmt_data <- df[df$major1 == "Management and Leadership", ]

# Create a separate histogram for each year
plot <- ggplot(mgmt_data, aes(x = survey_salary)) +
  geom_histogram(binwidth = 1000, fill = "blue", color = "black") +
  facet_wrap(~year.x, scales = "free_x") +
  labs(
    title = "Histogram of Management and Leadership Major Salaries",
    x = "Salary",
    y = "Frequency"
  ) +
  scale_x_continuous(labels = scales::number_format(scale = 1)) + 
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5))

interactive_plot <- ggplotly(plot)

interactive_plot
```

###

```{r, fig.width = 4, fig.height=2.5, echo=FALSE}
information_data <- df[df$major1 == "Information Systems", ]

# Create a separate histogram for each year
plot <- ggplot(information_data, aes(x = survey_salary)) +
  geom_histogram(binwidth = 1000, fill = "blue", color = "black") +
  facet_wrap(~year.x, scales = "free_x") +
  labs(
    title = "Histogram of Information Systems Major Salaries",
    x = "Salary",
    y = "Frequency"
  ) +
  scale_x_continuous(labels = scales::number_format(scale = 1)) + 
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5))

interactive_plot <- ggplotly(plot)

interactive_plot
```

###

```{r, fig.width = 4, fig.height=2.5, echo=FALSE}
human_data <- df[df$major1 == "Human Capital Mgmt& Leadership", ]

# Create a separate histogram for each year
plot <- ggplot(human_data, aes(x = survey_salary)) +
  geom_histogram(binwidth = 1000, fill = "blue", color = "black") +
  facet_wrap(~year.x, scales = "free_x") +
  labs(
    title = "Histogram of Human Capital Management Major Salaries",
    x = "Salary",
    y = "Frequency"
  ) +
  scale_x_continuous(labels = scales::number_format(scale = 1)) + 
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5))

interactive_plot <- ggplotly(plot)

interactive_plot
```
# FSB {data-orientation=columns}

## Column {data-width=400}

### Farmer's Average Salries by Major by Year

```{r,echo=FALSE}
result <- df %>%
  group_by(major1, year.x) %>%
  summarise(average_salary = mean(survey_salary, na.rm = TRUE)) %>%
  ungroup()

plotly_chart <- result %>%
  plot_ly(x = ~factor(year.x), y = ~average_salary, color = ~major1, type = "scatter", mode = "lines") %>%
  layout(
    xaxis = list(title = "Year"),
    yaxis = list(title = "Average Salary"),
    showlegend = TRUE
  )

plotly_chart
```

### FSB's Salaries as a Whole by Year

```{r,echo=FALSE}
x_axis_range <- c(0, 100000)  # Used 100,000 to get a more accurate look of the shape of the histogram

interactive_plot <- plot_ly(df, x = ~survey_salary, type = "histogram", 
                            xbins = list(start = x_axis_range[1], end = x_axis_range[2], size = 5000),
                            marker = list(color = "blue", line = list(color = "black")), autobinx = FALSE) %>%
  layout(
    title = "Histogram of FSB Salaries by Year",
    xaxis = list(title = "Salary"),
    yaxis = list(title = "Frequency"),
    bargap = 0  # Set bargap to 0 to have only one bar per bin
  )
interactive_plot
```


## Column {data-width=600}

### Comparable School's Average Salaries

```{r,echo=FALSE}
## Creating data frame for comparison. 

school = c("Miami", "Miami", "Miami", "Miami","Miami", "Miami", "Indiana", "Indiana", "Indiana", "Indiana","Indiana", "Indiana", "Ohio State", "Ohio State", "Ohio State", "Ohio State", "Ohio State", "Ohio State")

major = c("Accounting", "Economics", "Marketing", "Finance", "Information Systems", "Operations Management", "Accounting", "Economics", "Marketing", "Finance", "Information Systems", "Operations Management", "Accounting", "Economics", "Marketing", "Finance", "Information Systems", "Operations Management")

salary = c(59243, 60760, 52110, 61855, 66616, 56470, 66071, 72032, 60524, 72705, 70816, 64478, 57281, 57794, 55179, 63161, 68445, 58271)

df = data.frame(School = school, Major = major, Salary = salary)

plot <- plot_ly(df, x = ~Major, y = ~Salary, type = 'bar', text = ~School, color = ~School) %>%
  layout(title = "Average Salary by Major and School",
         xaxis = list(title = "Major"),
         yaxis = list(title = "Average Salary"))

plot
```


# Salaries by Top Companies {data-orientation=columns}

## Column {data-width=500}

### Top 10 Companies
```{r,echo=FALSE}
data = companies %>%
  #filter(intern_status == "Yes") %>%
  #filter(pay_status == "Yes") %>%
  group_by(survey_company, year.x, major1, survey_salary) %>%
  summarize(count=n()) %>%
  arrange(survey_company, year.x, major1, survey_salary, -count)

#data$employer = fct_explicit_na(data$employer, "unkown")
#finding all NAs and putting it into "unknown" category


datatable(data, rownames=F, extensions = "Buttons", 
          options =list(dom = "Bfrtip",
                        buttons=c("copy", "csv", "excel")
                        ),
          filter = list(position = "bottom",
                        clear=F,plain= T
                        )
          )
```

### Deloitte Average Salaries

```{r, echo =FALSE, fig.width = 8, fig.height=6}
#Deloitte Bar Chart

filtered_data <- companies %>%
  filter(survey_company == "DELOITTE") %>%
  group_by(major1, survey_company) %>%
  summarise(average_salary = mean(survey_salary))

# Create a responsive plotly bar chart for "DELOITTE"
plot_ly(filtered_data, x = ~major1, y = ~average_salary, type = "bar", marker = list(color = "blue")) %>%
  layout(xaxis = list(title = "Major"),
         yaxis = list(title = "Average Salary"),
         barmode = "group")

```

## Column {data-width=500}

### EY Average Salaries

```{r, echo = FALSE, fig.width = 4, fig.height=2.5}
#EY

filtered_data <- companies %>%
  filter(survey_company == "EY") %>%
  group_by(major1, survey_company) %>%
  summarise(average_salary = mean(survey_salary))

# Create a responsive plotly bar chart for "EY"
plot_ly(filtered_data, x = ~major1, y = ~average_salary, type = "bar", marker = list(color = "blue")) %>%
  layout(xaxis = list(title = "Major"),
         yaxis = list(title = "Average Salary"),
         barmode = "group")
```

### Textron Average Salries

```{r, echo = FALSE, fig.width = 4, fig.height=2.5}
#Textron Bar Chart

filtered_data <- companies %>%
  filter(survey_company == "TEXTRON") %>%
  group_by(major1, survey_company) %>%
  summarise(average_salary = mean(survey_salary))

# Create a responsive plotly bar chart for "TEXTRON"
plot_ly(filtered_data, x = ~major1, y = ~average_salary, type = "bar", marker = list(color = "blue")) %>%
  layout(xaxis = list(title = "Major"),
         yaxis = list(title = "Average Salary"),
         barmode = "group")

```


