knitr::opts_chunk$set(echo = TRUE,message=FALSE,warning=FALSE)
#package intialization
rm(list = ls()) # clear global environment
graphics.off() # close all graphics
if(require(pacman)==FALSE) install.packages("pacman")
pacman::p_load(DataExplorer,tidyverse,readxl,zoo,stargazer,kableExtra,skimr,plotly,ggpubr,vtable,tm)
data=readRDS(file = "FSB_BI_Survey_2019_2021.rds")
knitr::opts_chunk$set(echo = TRUE)
#package initialization
if(require(pacman)==FALSE) install.packages("pacman")
pacman::p_load(tidyverse, #for data manipulation
plotly, #for interactive plots
flexdashboard, #to make a dashboard
DT, #for interactive tables
fontawesome) #for icons
#load data
data=readRDS(file = "FSB_BI_Survey_2019_2021.rds")
knitr::opts_chunk$set(echo = TRUE,message=FALSE,warning=FALSE)
#package initialization
if(require(pacman)==FALSE) install.packages("pacman")
pacman::p_load(tidyverse, #for data manipulation
plotly, #for interactive plots
flexdashboard, #to make a dashboard
DT, #for interactive tables
fontawesome) #for icons
#load data
data=readRDS(file = "FSB_BI_Survey_2019_2021.rds")
knitr::opts_chunk$set(echo = TRUE,message=FALSE,warning=FALSE)
#package initialization
if(require(pacman)==FALSE) install.packages("pacman")
pacman::p_load(DataExplorer,tidyverse,readxl,zoo,stargazer,kableExtra,skimr,plotly,ggpubr,vtable,tm)
#load data
data=readRDS(file = "FSB_BI_Survey_2019_2021.rds")
knitr::opts_chunk$set(echo = TRUE,message=FALSE,warning=FALSE)
#package intialization
rm(list = ls()) # clear global environment
graphics.off() # close all graphics
if(require(pacman)==FALSE) install.packages("pacman")
pacman::p_load(DataExplorer,tidyverse,readxl,zoo,stargazer,kableExtra,skimr,plotly,ggpubr,vtable,tm)
data=readRDS(file = "FSB_BI_Survey_2019_2021.rds")
knitr::opts_chunk$set(echo = TRUE,message=FALSE,warning=FALSE)
#package initialization
if(require(pacman)==FALSE) install.packages("pacman")
pacman::p_load(DataExplorer,tidyverse,readxl,zoo,stargazer,kableExtra,skimr,plotly,ggpubr,vtable,tm)
#load data
data=readRDS(file = "FSB_BI_Survey_2019_2021.rds")
knitr::opts_chunk$set(echo = TRUE,message=FALSE,warning=FALSE)
#package initialization
if(require(pacman)==FALSE) install.packages("pacman")
pacman::p_load(DataExplorer,tidyverse,readxl,zoo,stargazer,kableExtra,skimr,plotly,ggpubr,vtable,tm, flexdashboard, fontawesome)
#load data
data=readRDS(file = "FSB_BI_Survey_2019_2021.rds")
knitr::opts_chunk$set(echo = TRUE,message=FALSE,warning=FALSE)
#package initialization
if(require(pacman)==FALSE) install.packages("pacman")
pacman::p_load(DataExplorer,tidyverse,readxl,zoo,stargazer,kableExtra,skimr,plotly,ggpubr,vtable,tm, flexdashboard, fontawesome)
knitr::opts_chunk$set(echo = TRUE,message=FALSE,warning=FALSE)
#package initialization
rm(list = ls()) # clear global environment
graphics.off() # close all graphics
if(require(pacman)==FALSE) install.packages("pacman")
pacman::p_load(DataExplorer,tidyverse,readxl,zoo,stargazer,kableExtra,skimr,plotly,ggpubr,vtable,tm, flexdashboard, fontawesome)
#load data
data=readRDS(file = "FSB_BI_Survey_2019_2021.rds")
#load data
data=readRDS(file = "FSB_BI_Survey_2019_2021.rds")
if(require(pacman)==FALSE) install.packages("pacman")
pacman::p_load(DataExplorer,tidyverse,readxl,zoo,stargazer,kableExtra,skimr,plotly,ggpubr,vtable,tm)
##read in the data
data=readRDS(file = "FSB_BI_Survey_2019_2021.rds")
#load data
data=readRDS("FSB_BI_Survey_2019_2021.rds")
#load data
data=readRDS("FSB_BI_Survey_2019_2021.RDS")
#load data
data=readRDS("FSB_BI_Survey_2019_2021.rds")
knitr::opts_chunk$set(echo = TRUE,message=FALSE,warning=FALSE)
#package initialization
rm(list = ls()) # clear global environment
graphics.off() # close all graphics
if(require(pacman)==FALSE) install.packages("pacman")
pacman::p_load(DataExplorer,tidyverse,readxl,zoo,stargazer,kableExtra,skimr,plotly,ggpubr,vtable,tm, flexdashboard, fontawesome)
#load data
data=readRDS("FSB_BI_Survey_2019_2021.rds")
data=readRDS(file = "FSB_BI_Survey_2019_2021.rds")
View(data)
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(fig.width=8, fig.height=6)
skim(data)
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(fig.width=8, fig.height=6)
if(require(pacman)==FALSE)
install.packages("pacman")## Loading package manager: pacman
pacman::p_load(readxl, gptstudio, httr, tidyverse, corrplot, DataExplorer,skimr, effects)
data = readRDS(file = "FSB_BI_Survey_2019_2021.rds")
skim(data)
library(skimr)
skim(data)
sessionInfo()
levels(data.major1)
levels(major1)
levels(data$major1)
levels(data$major1)
levels(data$major2)
levels(data$survey_plans)
levels(data$Gender)
levels(data$IPEDS.Race.Ethnicity)
levels(data$survey_company)
levels(data$major1)
levels(data$major2)
levels(data$survey_plans)
table(data$Gender)
levels(data$IPEDS.Race.Ethnicity)
levels(data$survey_company)
levels(data$major1)
levels(data$major2)
table(data$survey_plans)
table(data$Gender)
table(data$IPEDS.Race.Ethnicity)
table(data$survey_company)
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(fig.width=8, fig.height=6)
top20companies = as.data.frame(table(data$survey_company))
top20sorted = top20companies[order(-top20companies$Freq), ]
head(top20sorted, 20)
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(fig.width=8, fig.height=6)
df['survey_company'] = df['survey_company'].str.upper()
data['survey_company'] = toupper(data['survey_company'])
data['survey_company]
#top20companies = as.data.frame(table(data$survey_company))
#top20sorted = top20companies[order(-top20companies$Freq), ]
#head(top20sorted, 20)
data['survey_company'] = toupper(data['survey_company'])
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(fig.width=8, fig.height=6)
if(require(pacman)==FALSE)
install.packages("pacman")## Loading package manager: pacman
pacman::p_load(readxl, gptstudio, httr, tidyverse, corrplot, DataExplorer,skimr, effects)
data = readRDS(file = "FSB_BI_Survey_2019_2021.rds")
skim(data)
levels(data$major1)
levels(data$major2)
levels(data$Year.x)
table(data$survey_plans)
table(data$Gender)
table(data$IPEDS.Race.Ethnicity)
data['survey_company'] = toupper(data['survey_company'])
top20companies = as.data.frame(table(data$survey_company))
top20sorted = top20companies[order(-top20companies$Freq), ]
head(top20sorted, 20)
library(skimr)
skim(data)
sessionInfo()
#data['survey_company'] = toupper(data['survey_company'])
top20companies = as.data.frame(table(data$survey_company))
top20sorted = top20companies[order(-top20companies$Freq), ]
head(top20sorted, 20)
data$survey_company = toupper(data$survey_company)
top20companies = as.data.frame(table(data$survey_company))
top20sorted = top20companies[order(-top20companies$Freq), ]
head(top20sorted, 20)
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(fig.width=8, fig.height=6)
if(require(pacman)==FALSE)
install.packages("pacman")## Loading package manager: pacman
pacman::p_load(readxl, gptstudio, httr, tidyverse, corrplot, DataExplorer,skimr, effects)
data = readRDS(file = "FSB_BI_Survey_2019_2021.rds")
skim(data)
levels(data$major1)
levels(data$major2)
levels(data$Year.x)
table(data$survey_plans)
table(data$Gender)
table(data$IPEDS.Race.Ethnicity)
data$survey_company = toupper(data$survey_company)
top20companies = as.data.frame(table(data$survey_company))
top20sorted = top20companies[order(-top20companies$Freq), ]
head(top20sorted, 20)
library(skimr)
skim(data)
sessionInfo()
data$survey_company
data$survey_company = sub("DELOITTE CONSULTING", "DELOITTE", data$survey_company)
data[data$survey_company == "DELOITTE CONSULTING"] = "DELOITTE"
data$survey_company[data$survey_company == "DELOITTE CONSULTING"] = "DELOITTE"
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(fig.width=8, fig.height=6)
if(require(pacman)==FALSE)
install.packages("pacman")## Loading package manager: pacman
pacman::p_load(readxl, gptstudio, httr, tidyverse, corrplot, DataExplorer,skimr, effects)
data = readRDS(file = "FSB_BI_Survey_2019_2021.rds")
skim(data)
levels(data$major1)
levels(data$major2)
levels(data$Year.x)
table(data$survey_plans)
table(data$Gender)
table(data$IPEDS.Race.Ethnicity)
data$survey_company = toupper(data$survey_company)
top20companies = as.data.frame(table(data$survey_company))
top20sorted = top20companies[order(-top20companies$Freq), ]
head(top20sorted, 20)
data$survey_company[data$survey_company == "DELOITTE CONSULTING"] = "DELOITTE"
library(skimr)
skim(data)
sessionInfo()
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(fig.width=8, fig.height=6)
levels(data$major1)
levels(data$major2)
table(data$Year.x)
table(data$survey_plans)
table(data$Gender)
table(data$IPEDS.Race.Ethnicity)
levels(data$major1)
levels(data$major2)
table(data$year.x)
table(data$survey_plans)
table(data$Gender)
table(data$IPEDS.Race.Ethnicity)
library(dplyr)
# Filter the data for the specific years and majors
filtered_data <- data %>%
filter(year.x %in% 2019:2021, major1 %in% c("Accountancy", "Business Analytics", "Business Economics", "Entrepreneurship", "Finance", "General Business", "Human Capital Mgmt& Leadership", "Information Systems", "Interdisciplinary Bus Managemt", "Management and Leadership", "Management and Organizations", "Marketing"))
# Group the data by major and year and calculate the mean of survey_salary for each group
mean_imputed_data <- filtered_data %>%
group_by(major1, year.x) %>%
mutate(survey_salary = ifelse(is.na(survey_salary), mean(survey_salary, na.rm = TRUE), survey_salary)) %>%
ungroup()
# Update the original data with the mean-imputed values
data <- data %>%
left_join(mean_imputed_data, by = c("major1", "year.x", "survey_salary"))
# Clean up
rm(filtered_data, mean_imputed_data)
if(require(pacman)==FALSE)
install.packages("pacman")## Loading package manager: pacman
pacman::p_load(readxl, gptstudio, httr, tidyverse, corrplot, DataExplorer,skimr, effects, dplyr)
# Filter the data for the specific years and majors
filtered_data <- data %>%
filter(year.x %in% 2019:2021, major1 %in% c("Accountancy", "Business Analytics", "Business Economics", "Entrepreneurship", "Finance", "General Business", "Human Capital Mgmt& Leadership", "Information Systems", "Interdisciplinary Bus Managemt", "Management and Leadership", "Management and Organizations", "Marketing"))
# Group the data by major and year and calculate the mean of survey_salary for each group
mean_imputed_data <- filtered_data %>%
group_by(major1, year.x) %>%
mutate(survey_salary = ifelse(is.na(survey_salary), mean(survey_salary, na.rm = TRUE), survey_salary)) %>%
ungroup()
# Update the original data with the mean-imputed values
data <- data %>%
left_join(mean_imputed_data, by = c("major1", "year.x", "survey_salary"))
# Clean up
rm(filtered_data, mean_imputed_data)
# Filter the data for the specific years and majors
filtered_data <- data %>%
filter(year.x %in% 2019:2021, major1 %in% c("Accountancy", "Business Analytics", "Business Economics", "Entrepreneurship", "Finance", "General Business", "Human Capital Mgmt& Leadership", "Information Systems", "Interdisciplinary Bus Managemt", "Management and Leadership", "Management and Organizations", "Marketing"))
# Group the data by major and year and calculate the mean of survey_salary for each group
mean_imputed_data <- filtered_data %>%
group_by(major1, Year.x, survey_salary) %>%
summarize(mean_survey_salary = mean(survey_salary, na.rm = TRUE), .groups = "drop")
# Filter the data for the specific years and majors
filtered_data <- data %>%
filter(year.x %in% 2019:2021, major1 %in% c("Accountancy", "Business Analytics", "Business Economics", "Entrepreneurship", "Finance", "General Business", "Human Capital Mgmt& Leadership", "Information Systems", "Interdisciplinary Bus Managemt", "Management and Leadership", "Management and Organizations", "Marketing"))
# Group the data by major and year and calculate the mean of survey_salary for each group
mean_imputed_data <- filtered_data %>%
group_by(major1, year.x, survey_salary) %>%
summarize(mean_survey_salary = mean(survey_salary, na.rm = TRUE), .groups = "drop")
# Perform the left join as before
data <- data %>%
left_join(mean_imputed_data, by = c("major1", "year.x", "survey_salary"))
# Clean up
rm(filtered_data, mean_imputed_data)
print(sum(is.na(data$survey_salary)))
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(fig.width=8, fig.height=6)
if(require(pacman)==FALSE)
install.packages("pacman")## Loading package manager: pacman
pacman::p_load(readxl, gptstudio, httr, tidyverse, corrplot, DataExplorer,skimr, effects, dplyr)
data = readRDS(file = "FSB_BI_Survey_2019_2021.rds")
skim(data)
levels(data$major1)
levels(data$major2)
table(data$year.x)
table(data$survey_plans)
table(data$Gender)
table(data$IPEDS.Race.Ethnicity)
data$survey_company = toupper(data$survey_company)
top20companies = as.data.frame(table(data$survey_company))
top20sorted = top20companies[order(-top20companies$Freq), ]
head(top20sorted, 20)
data$survey_company[data$survey_company == "DELOITTE CONSULTING"] = "DELOITTE"
print(sum(is.na(data$survey_salary)))
# Filter the data for the specific years and majors
filtered_data <- data %>%
filter(year.x %in% 2019:2021, major1 %in% c("Accountancy", "Business Analytics", "Business Economics", "Entrepreneurship", "Finance", "General Business", "Human Capital Mgmt& Leadership", "Information Systems", "Interdisciplinary Bus Managemt", "Management and Leadership", "Management and Organizations", "Marketing"))
# Group the data by major and year and calculate the mean of survey_salary for each group
mean_imputed_data <- filtered_data %>%
group_by(major1, year.x, survey_salary) %>%
summarize(mean_survey_salary = mean(survey_salary, na.rm = TRUE), .groups = "drop")
# Perform the left join as before
data <- data %>%
left_join(mean_imputed_data, by = c("major1", "year.x", "survey_salary"))
# Clean up
rm(filtered_data, mean_imputed_data)
print(sum(is.na(data$survey_salary)))
library(skimr)
skim(data)
sessionInfo()
head(data)
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(fig.width=8, fig.height=6)
if(require(pacman)==FALSE)
install.packages("pacman")## Loading package manager: pacman
pacman::p_load(readxl, gptstudio, httr, tidyverse, corrplot, DataExplorer,skimr, effects, dplyr)
data = readRDS(file = "FSB_BI_Survey_2019_2021.rds")
skim(data)
levels(data$major1)
levels(data$major2)
table(data$year.x)
table(data$survey_plans)
table(data$Gender)
table(data$IPEDS.Race.Ethnicity)
data$survey_company = toupper(data$survey_company)
top20companies = as.data.frame(table(data$survey_company))
top20sorted = top20companies[order(-top20companies$Freq), ]
head(top20sorted, 20)
data$survey_company[data$survey_company == "DELOITTE CONSULTING"] = "DELOITTE"
library(skimr)
skim(data)
sessionInfo()
# Calculate the mean salary for each major
mean_salary_by_major <- data %>%
group_by(major1) %>%
summarize(mean_salary = mean(survey_salary, na.rm = TRUE))
# Merge the mean salary information back into the original data frame
data <- data %>%
left_join(mean_salary_by_major, by = "major")
# Calculate the mean salary for each major
mean_salary_by_major <- data %>%
group_by(major1) %>%
summarize(mean_salary = mean(survey_salary, na.rm = TRUE))
# Merge the mean salary information back into the original data frame
data <- data %>%
left_join(mean_salary_by_major, by = "major1")
# Impute missing salary values with the mean salary for that major
data$salary[is.na(data$survey_salary)] <- data$mean_salary[is.na(data$survey_salary)]
# Remove the mean_salary column if you don't need it anymore
data <- data %>% select(-mean_salary)
head(data)
